GAMS 35.2.0  r33388c4 Released Jun  2, 2021 WEX-WEI x86 64bit/MS Windows - 10/06/21 09:50:10 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  Sets
   2  all_t       all hours               /1*10/
   3  t(all_t)    hours                   /1*3/
   4  tec         generators              /base, peak, wind, solar/
   5  con(tec)    conventional generation /base, peak/
   6  all_n       all buses               /west, east, south/
   7  n(all_n)    selected buses          /west, east/
   8  ;
   9   
  10  alias (n,m);
  11  alias (all_n,all_m);
  12   
  13  * parameters for supply and demand functions
  14  Parameter elasticity / -0.25 /;
  15  Parameter p_ref / 65 /;
  16  Parameter specific_network_costs /255/;
  17  *Source for network costs: EMMA (3400 EUR/MW/km discontiert mit i = 0.07 ueber 40 Jahre)
  18   
  19  Table B(all_n,all_m)        Susceptance of transmission lines
  20           west   east    south
  21  west        1    300      800
  22  east      300      1      500
  23  south     800    500        1
  24  ;
  25   
  26  Parameters
  27  * Input Parameters
  28  i_cost(*,*)                 cost data to be loaded from sheet "cost"
  29  i_load(all_t,all_n)         load data to be loaded from sheet "time series" in MWh
  30  i_avail(all_t,tec,all_n)    availability data
  31   
  32  * Model Parameters
  33  load(t,n)                   hourly load in GWh
  34  avail(t,tec,n)              availability of wind and solar generation (1)
  35  c_var(tec,n)                variable costs (EUR per MWh)
  36  c_fix(tec,n)                annualized fixed costs (EUR per MW p.a.)
  37  capacity_slope
  38  cap_lim(tec,n)              capacity limit of generation in each node
  39  grid_cost(n,m)
  40  sc                          scaling factor
  41  INSTRUMENT(tec,n)
  42   
  43  * Output Parameters
  44  consumer_surplus
  45  generation_costs
  46  total_network_cost
  47  load_deviation(t)
  48  res_share
  49  marginal_fixed_costs(tec,n)
  50  fixed_linear_costs(tec,n)
  51  max_marginal_price_adder(tec,n)
  52  variable_costs(tec,n)
  53  o_WF
  54  o_CS
  55  o_GC
  56  o_NC
  57  o_RES_share
  58  o_load(t,n)
  59  o_cap(tec,n)
  60  price(t)
  61  o_cap_instr(tec,n)
  62  o_instrument(tec,n)
  63   
  64  i_WF
  65  i_instrument(tec,n)
  66  i_cap(tec,n)
  67  i_lambda(t)
  68  i_load_real(t,n)
  69  i_gen(t,tec,n)
  70  i_grid_cap(n,m)
  71  i_flow(t,n,m)
  72  i_up(t,tec,n)
  73  i_down(t,tec,n)
  74  i_mu_G_min(t,tec,n)
  75  i_mu_G_max(t,tec,n)
  76  i_mu_C_min(tec,n)
  77  i_mu_C_max(tec,n)
  78  i_mu_D_min(t,n)
  79  ;
  80   
  81  * Load data
GDXIN   C:\Users\ansel\OneDrive\PhD\2 - Where to place new power generation\Three node models\Model testing\in.gdx
--- LOAD  i_cost = 1:i_cost
--- LOAD  i_load = 2:i_load
--- LOAD  i_avail = 3:i_avail
  84   
  85  * Data assignment
  86  sc = card(t) / 8760;
  87  load(t,n)                   = i_load(t,n) / 1000;
  88  avail(t,tec,n)              = i_avail(t,tec,n);
  89  avail(t,con,n)              = 1;
  90  c_var(tec, n)               = i_cost(tec,"cost_var");
  91  c_fix(tec, n)               = round(i_cost(tec,"cost_fix") * 1000 * sc);
  92  capacity_slope              = 0.15;
  93  *c_fix('wind','south')  * 0.25 / 50;
  94  cap_lim(tec,n)              = 100;
  95  grid_cost(n,m)              = round(B(n,m) * specific_network_costs * sc);
  96  INSTRUMENT(tec,n)     = 0;
  97   
  98  Variables
  99  GEN(t,tec,n)
 100  CAP(tec,n)
 101  LOAD_real(t,n)
 102  LAMBDA(t)
 103  RHO(t,tec,n)
 104  WF
 105  ;
 106   
 107  Positive variables
 108  mu_G_min(t,tec,n)
 109  mu_G_max(t,tec,n)
 110  mu_C_min(tec,n)
 111  mu_C_max(tec,n)
 112  mu_D_min(t,n)
 113   
 114  UP(t,tec,n)
 115  DOWN(t,tec,n)
 116  SHARE(t,tec)
 117  ;
 118   
 119   
 120  Equations
 121  Objective, gen_min, gen_max, cap_min, cap_max;
 122   
 123  Objective..             WF =e= sum(t, p_ref * sum((tec,n), GEN(t,tec,n)) * (1-1/elasticity +  sum((tec,n), GEN(t,tec,n)) / (2*elasticity* sum(n,load(t,n)))))
 124                                  - sum((tec,n), CAP(tec,n)* (c_fix(tec,n) + INSTRUMENT(tec,n)) + 0.5 * CAP(tec,n) * CAP(tec,n) * capacity_slope)
 125                                  - sum((t,tec,n), GEN(t,tec,n) * c_var(tec,n));
 126   
 127  gen_max(t,tec,n)..      0 =g= GEN(t,tec,n) - CAP(tec,n) * avail(t,tec,n);
 128  gen_min(t,tec,n)..      0 =g= -GEN(t,tec,n);
 129  cap_max(tec,n)..        0 =g= CAP(tec,n) - cap_lim(tec,n);
 130  cap_min(tec,n)..        0 =g= -CAP(tec,n);
 131   
 132   
 133  Model LOCI /
 134   
 135  objective
 136  gen_min
 137  gen_max
 138  cap_min
 139  cap_max
 140   
 141  /;
 142   
 143  * Set starting values
 144  *CAP.l(tec,n) = o_cap(tec,n);
 145  *LOAD_real.L(t,n) =load(t,n);
 146  *GRID.L = 20;
 147  *LOAD_real.lo(t,n) = 0.2 * load(t,n);
 148  *LAMBDA.up(t) = 90;
 149   
 150  Solve LOCI maximizing WF using QCP;
 151  *option MCP = NLPEC;
 152   
 153  price(t) = p_ref * (1-(1/elasticity) + (sum((tec,n), GEN.L(t,tec,n)) / sum(n, elasticity * load(t,n))));
 154  load_deviation(t) = sum((tec,n), GEN.L(t,tec,n)) / sum(n,load(t,n));
 155   
 156  Display GEN.L, CAP.L, price, load_deviation;
 157  *,WF.L,  GRID.L, LAMBDA.L, LOAD_real.L, CAP_INSTR.L, UP.L, DOWN.L, RESERVE_CAP.L, FLOW.L;
GAMS 35.2.0  r33388c4 Released Jun  2, 2021 WEX-WEI x86 64bit/MS Windows - 10/06/21 09:50:10 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  C:\Users\ansel\OneDrive\PhD\2 - Where to place new power generation\Three node models\Model testing\LP_CS_and_PS.gms
     2       82 GDXIN          1      82  C:\Users\ansel\OneDrive\PhD\2 - Where to place new power generation\Three node models\Model testing\in.gdx


COMPILATION TIME     =        0.000 SECONDS      3 MB  35.2.0 r33388c4 WEX-WEI
GAMS 35.2.0  r33388c4 Released Jun  2, 2021 WEX-WEI x86 64bit/MS Windows - 10/06/21 09:50:10 Page 3
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE LOCI Using QCP From line 150


---- Objective  =E=  

Objective..  - (260)*GEN(1,base,west) - (260)*GEN(1,base,east) - (245)*GEN(1,peak,west) - (245)*GEN(1,peak,east) - (325)*GEN(1,wind,west) - (325)*GEN(1,wind,east) - (325)*GEN(1,solar,west) - (325)*GEN(1,solar,east) - (260)*GEN(2,base,west) - (260)*GEN(2,base,east) - (245)*GEN(2,peak,west) - (245)*GEN(2,peak,east) - (325)*GEN(2,wind,west) - (325)*GEN(2,wind,east) - (325)*GEN(2,solar,west) - (325)*GEN(2,solar,east) - (260)*GEN(3,base,west) - (260)*GEN(3,base,east) - (245)*GEN(3,peak,west) - (245)*GEN(3,peak,east) - (325)*GEN(3,wind,west) - (325)*GEN(3,wind,east) - (325)*GEN(3,solar,west) - (325)*GEN(3,solar,east) + (38)*CAP(base,west) + (38)*CAP(base,east) + (11)*CAP(peak,west) + (11)*CAP(peak,east) + (27)*CAP(wind,west) + (27)*CAP(wind,east) + (15)*CAP(solar,west) + (15)*CAP(solar,east) + WF =E= 0 ; (LHS = 0)
     

---- gen_min  =G=  

gen_min(1,base,west)..  GEN(1,base,west) =G= 0 ; (LHS = 0)
     
gen_min(1,base,east)..  GEN(1,base,east) =G= 0 ; (LHS = 0)
     
gen_min(1,peak,west)..  GEN(1,peak,west) =G= 0 ; (LHS = 0)
     
REMAINING 21 ENTRIES SKIPPED


---- gen_max  =G=  

gen_max(1,base,west)..  - GEN(1,base,west) + CAP(base,west) =G= 0 ; (LHS = 0)
     
gen_max(1,base,east)..  - GEN(1,base,east) + CAP(base,east) =G= 0 ; (LHS = 0)
     
gen_max(1,peak,west)..  - GEN(1,peak,west) + CAP(peak,west) =G= 0 ; (LHS = 0)
     
REMAINING 21 ENTRIES SKIPPED


---- cap_min  =G=  

cap_min(base,west)..  CAP(base,west) =G= 0 ; (LHS = 0)
     
cap_min(base,east)..  CAP(base,east) =G= 0 ; (LHS = 0)
     
cap_min(peak,west)..  CAP(peak,west) =G= 0 ; (LHS = 0)
     
REMAINING 5 ENTRIES SKIPPED


---- cap_max  =G=  

cap_max(base,west)..  - CAP(base,west) =G= -100 ; (LHS = 0)
     
cap_max(base,east)..  - CAP(base,east) =G= -100 ; (LHS = 0)
     
cap_max(peak,west)..  - CAP(peak,west) =G= -100 ; (LHS = 0)
     
REMAINING 5 ENTRIES SKIPPED

GAMS 35.2.0  r33388c4 Released Jun  2, 2021 WEX-WEI x86 64bit/MS Windows - 10/06/21 09:50:10 Page 4
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE LOCI Using QCP From line 150


---- GEN  

GEN(1,base,west)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
    (-260)      Objective
        1       gen_min(1,base,west)
       -1       gen_max(1,base,west)

GEN(1,base,east)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
    (-260)      Objective
        1       gen_min(1,base,east)
       -1       gen_max(1,base,east)

GEN(1,peak,west)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
    (-245)      Objective
        1       gen_min(1,peak,west)
       -1       gen_max(1,peak,west)

REMAINING 21 ENTRIES SKIPPED

---- CAP  

CAP(base,west)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
      (38)      Objective
        1       gen_max(1,base,west)
        1       gen_max(2,base,west)
        1       gen_max(3,base,west)
        1       cap_min(base,west)
       -1       cap_max(base,west)

CAP(base,east)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
      (38)      Objective
        1       gen_max(1,base,east)
        1       gen_max(2,base,east)
        1       gen_max(3,base,east)
        1       cap_min(base,east)
       -1       cap_max(base,east)

CAP(peak,west)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
      (11)      Objective
        1       gen_max(1,peak,west)
        1       gen_max(2,peak,west)
        1       gen_max(3,peak,west)
        1       cap_min(peak,west)
       -1       cap_max(peak,west)

REMAINING 5 ENTRIES SKIPPED

---- WF  

WF
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       Objective

GAMS 35.2.0  r33388c4 Released Jun  2, 2021 WEX-WEI x86 64bit/MS Windows - 10/06/21 09:50:10 Page 5
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Model Statistics    SOLVE LOCI Using QCP From line 150


MODEL STATISTICS

BLOCKS OF EQUATIONS           5     SINGLE EQUATIONS           65
BLOCKS OF VARIABLES           3     SINGLE VARIABLES           33
NON ZERO ELEMENTS           119     NON LINEAR N-Z             32
CODE LENGTH                 187     CONSTANT POOL              27


GENERATION TIME      =        0.000 SECONDS      4 MB  35.2.0 r33388c4 WEX-WEI
GAMS 35.2.0  r33388c4 Released Jun  2, 2021 WEX-WEI x86 64bit/MS Windows - 10/06/21 09:50:10 Page 6
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE LOCI Using QCP From line 150


               S O L V E      S U M M A R Y

     MODEL   LOCI                OBJECTIVE  WF
     TYPE    QCP                 DIRECTION  MAXIMIZE
     SOLVER  CONOPT              FROM LINE  150

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      2 Locally Optimal           
**** OBJECTIVE VALUE            20337.1341

 RESOURCE USAGE, LIMIT          0.078 10000000000.000
 ITERATION COUNT, LIMIT        16    2147483647
 EVALUATION ERRORS              0             0
--- *** This solver runs with a community license. No commercial use.
 
 
    C O N O P T 3   version 3.17K
    Copyright (C)   ARKI Consulting and Development A/S
                    Bagsvaerdvej 246 A
                    DK-2880 Bagsvaerd, Denmark
 
 
    The model has 33 variables and 65 constraints
    with 119 Jacobian elements, 32 of which are nonlinear.
    The Hessian of the Lagrangian has 32 elements on the diagonal,
    84 elements below the diagonal, and 32 nonlinear variables.
 
 ** Warning **  The value of LFITER is out of range.
                LFITER is decreased from 2147483647 to 1000000000.
 
                   Pre-triangular equations:   0
                   Post-triangular equations:  1
 
 
 ** Optimal solution. Reduced gradient less than tolerance.
 
 
 CONOPT time Total                            0.035 seconds
   of which: Function evaluations             0.002 =  5.7%
             1st Derivative evaluations       0.001 =  2.9%
             2nd Derivative evaluations       0.000 =  0.0%
             Directional 2nd Derivative       0.001 =  2.9%
 

                           LOWER          LEVEL          UPPER         MARGINAL

---- EQU Objective           .              .              .             1.0000      

---- EQU gen_min  

                    LOWER          LEVEL          UPPER         MARGINAL

1.base .west          .             4.4255        +INF            EPS         
1.base .east          .             4.4255        +INF            EPS         
1.peak .west          .              .            +INF          -11.7169      
1.peak .east          .              .            +INF          -11.7169      
1.wind .west          .            25.0000        +INF             .          
1.wind .east          .            15.0000        +INF             .          
1.solar.west          .              .            +INF           -2.1499      
1.solar.east          .             3.6821        +INF            EPS         
2.base .west          .             4.4255        +INF             .          
2.base .east          .             4.4255        +INF             .          
2.peak .west          .             2.2632        +INF             .          
2.peak .east          .             2.2632        +INF             .          
2.wind .west          .            15.0000        +INF             .          
2.wind .east          .            18.0000        +INF             .          
2.solar.west          .              .            +INF             .          
2.solar.east          .             0.1534        +INF             .          
3.base .west          .             4.4255        +INF             .          
3.base .east          .             4.4255        +INF             .          
3.peak .west          .              .            +INF           -5.9587      
3.peak .east          .              .            +INF           -5.9587      
3.wind .west          .            20.0000        +INF             .          
3.wind .east          .            21.0000        +INF             .          
3.solar.west          .              .            +INF             .          
3.solar.east          .              .            +INF             .          

---- EQU gen_max  

                    LOWER          LEVEL          UPPER         MARGINAL

1.base .west          .              .            +INF           -3.2831      
1.base .east          .              .            +INF           -3.2831      
1.peak .west          .             2.2632        +INF             .          
1.peak .east          .             2.2632        +INF            EPS         
1.wind .west          .              .            +INF          -68.2831      
1.wind .east          .              .            +INF          -68.2831      
1.solar.west          .              .            +INF          -70.4330      
1.solar.east          .              .            +INF          -68.2831      
2.base .west          .              .            +INF          -26.3395      
2.base .east          .              .            +INF          -26.3395      
2.peak .west          .              .            +INF          -11.3395      
2.peak .east          .              .            +INF          -11.3395      
2.wind .west          .              .            +INF          -91.3395      
2.wind .east          .              .            +INF          -91.3395      
2.solar.west          .              .            +INF          -91.3395      
2.solar.east          .              .            +INF          -91.3395      
3.base .west          .              .            +INF           -9.0413      
3.base .east          .              .            +INF           -9.0413      
3.peak .west          .             2.2632        +INF             .          
3.peak .east          .             2.2632        +INF             .          
3.wind .west          .              .            +INF          -74.0413      
3.wind .east          .              .            +INF          -74.0413      
3.solar.west          .              .            +INF          -74.0413      
3.solar.east          .              .            +INF          -74.0413      

---- EQU cap_min  

                  LOWER          LEVEL          UPPER         MARGINAL

base .west          .             4.4255        +INF             .          
base .east          .             4.4255        +INF             .          
peak .west          .             2.2632        +INF             .          
peak .east          .             2.2632        +INF             .          
wind .west          .           100.0000        +INF             .          
wind .east          .           100.0000        +INF             .          
solar.west          .              .            +INF             .          
solar.east          .            15.3423        +INF             .          

---- EQU cap_max  

                  LOWER          LEVEL          UPPER         MARGINAL

base .west      -100.0000        -4.4255        +INF             .          
base .east      -100.0000        -4.4255        +INF             .          
peak .west      -100.0000        -2.2632        +INF            EPS         
peak .east      -100.0000        -2.2632        +INF             .          
wind .west      -100.0000      -100.0000        +INF           -3.5799      
wind .east      -100.0000      -100.0000        +INF           -0.2322      
solar.west      -100.0000   3.463896E-14        +INF             .          
solar.east      -100.0000       -15.3423        +INF             .          

---- VAR GEN  

                    LOWER          LEVEL          UPPER         MARGINAL

1.base .west        -INF            4.4255        +INF             .          
1.base .east        -INF            4.4255        +INF             .          
1.peak .west        -INF             .            +INF             .          
1.peak .east        -INF             .            +INF             .          
1.wind .west        -INF           25.0000        +INF             .          
1.wind .east        -INF           15.0000        +INF             .          
1.solar.west        -INF      1.065814E-14        +INF             .          
1.solar.east        -INF            3.6821        +INF             .          
2.base .west        -INF            4.4255        +INF             .          
2.base .east        -INF            4.4255        +INF             .          
2.peak .west        -INF            2.2632        +INF             .          
2.peak .east        -INF            2.2632        +INF             .          
2.wind .west        -INF           15.0000        +INF             .          
2.wind .east        -INF           18.0000        +INF             .          
2.solar.west        -INF      8.656270E-16        +INF             .          
2.solar.east        -INF            0.1534        +INF             .          
3.base .west        -INF            4.4255        +INF             .          
3.base .east        -INF            4.4255        +INF             .          
3.peak .west        -INF             .            +INF             .          
3.peak .east        -INF             .            +INF             .          
3.wind .west        -INF           20.0000        +INF             .          
3.wind .east        -INF           21.0000        +INF             .          
3.solar.west        -INF             .            +INF             .          
3.solar.east        -INF             .            +INF             .          

---- VAR CAP  

                  LOWER          LEVEL          UPPER         MARGINAL

base .west        -INF            4.4255        +INF             .          
base .east        -INF            4.4255        +INF             .          
peak .west        -INF            2.2632        +INF             .          
peak .east        -INF            2.2632        +INF             .          
wind .west        -INF          100.0000        +INF             .          
wind .east        -INF          100.0000        +INF             .          
solar.west        -INF      -3.46390E-14        +INF             .          
solar.east        -INF           15.3423        +INF             .          

                           LOWER          LEVEL          UPPER         MARGINAL

---- VAR WF                -INF        20337.1341        +INF             .          


**** REPORT SUMMARY :        0     NONOPT
                             0 INFEASIBLE
                             0  UNBOUNDED
                             0     ERRORS
                             2  PROJECTED
GAMS 35.2.0  r33388c4 Released Jun  2, 2021 WEX-WEI x86 64bit/MS Windows - 10/06/21 09:50:10 Page 7
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


----    156 VARIABLE GEN.L  

               west        east

1.base        4.426       4.426
1.wind       25.000      15.000
1.solar 1.06581E-14       3.682
2.base        4.426       4.426
2.peak        2.263       2.263
2.wind       15.000      18.000
2.solar 8.65627E-16       0.153
3.base        4.426       4.426
3.wind       20.000      21.000


----    156 VARIABLE CAP.L  

             west        east

base        4.426       4.426
peak        2.263       2.263
wind      100.000     100.000
solar -3.4639E-14      15.342


----    156 PARAMETER price  

1 68.283,    2 91.339,    3 74.041


----    156 PARAMETER load_deviation  

1 0.987,    2 0.899,    3 0.965



EXECUTION TIME       =        0.297 SECONDS      4 MB  35.2.0 r33388c4 WEX-WEI


USER: GAMS Community License for Anselm Eicke        G210709|0002AO-GEN
      Hertie School of Governance GmbH                           CL1515
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      C:\Users\ansel\OneDrive\PhD\2 - Where to place new power generation\Three node models\Model testing\LP_CS_and_PS.gms
Output     C:\Users\ansel\OneDrive\PhD\2 - Where to place new power generation\Three node models\Model testing\LP_CS_and_PS.lst
